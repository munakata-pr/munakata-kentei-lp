<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宗像検定 | 宗像の魅力を再発見</title>
    <meta name="description" content="宗像市の歴史・文化・特産品を学ぶクイズ検定。課長・部長・市長コースに挑戦して、宗像の魅力を再発見しよう！">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Noto+Serif+JP:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/quiz.css">
    <style>
        /* Quiz Specific Overrides */
        .result-icon {
            display: inline-flex;
            width: 24px;
            height: 24px;
            background: var(--navy);
            color: white;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-right: 8px;
        }

        .result-icon.success {
            background: var(--vermilion);
        }

        .review-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            line-height: 20px;
            text-align: center;
            border-radius: 50%;
            color: white;
            font-weight: bold;
            font-size: 12px;
            margin-right: 8px;
        }

        .review-icon.correct {
            background: var(--navy);
        }

        .review-icon.incorrect {
            background: #e74c3c;
        }

        /* Exam Section Visibility */
        .exam-section {
            display: none;
        }

        .exam-section.active {
            display: block;
        }

        #difficulty-selection.hidden {
            display: none;
        }

        #result-section {
            display: none;
        }

        #result-section.active {
            display: block;
        }
    </style>
</head>

<body>

    <!-- Header -->
    <header class="site-header">
        <div class="header-container">
            <a href="../index.html" class="logo">
                <img src="../images/logo_mark.svg" onerror="this.style.display='none'" alt=""> 宗像検定
            </a>
            <ul class="nav-links">
                <li><a href="../index.html#concept">検定とは</a></li>
                <li><a href="../index.html#courses">コース紹介</a></li>
                <li><a href="../kanko/index.html">観光編</a></li>
            </ul>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>宗像検定<br>公式クイズ</h1>
            <p>学び、楽しみ、好きになる。<br>3つのコースで宗像マスターを目指そう。</p>
        </div>
    </section>

    <div class="container">
        <!-- 難易度選択 -->
        <div id="difficulty-selection">
            <div class="mb-4 text-center">
                <h2 style="font-family:'Noto Serif JP'; margin-bottom:1rem;">コース選択</h2>
                <p>現在の知識レベルに合わせてコースを選んでください。</p>
            </div>

            <div class="difficulty-card beginner" onclick="startExam('beginner')">
                <img src="../images/course_kacho.webp" alt="課長コース" class="difficulty-icon"
                    onerror="this.style.backgroundColor='#ccc'">
                <h3>課長コース</h3>
                <p>基本情報をしっかり理解しよう</p>
                <button class="cta-button">受検する →</button>
            </div>

            <div class="difficulty-card intermediate" onclick="startExam('intermediate')">
                <img src="../images/course_bucho.webp" alt="部長コース" class="difficulty-icon"
                    onerror="this.style.backgroundColor='#ccc'">
                <h3>部長コース</h3>
                <p>詳細な情報を理解しよう</p>
                <button class="cta-button">受検する →</button>
            </div>

            <div class="difficulty-card advanced" onclick="startExam('advanced')">
                <img src="../images/course_shicho.webp" alt="市長コース" class="difficulty-icon"
                    onerror="this.style.backgroundColor='#ccc'">
                <h3>市長コース</h3>
                <p>複合的な分析力を試そう</p>
                <button class="cta-button">受検する →</button>
            </div>

            <div class="text-center" style="margin-top:3rem;">
                <a href="../kanko/index.html" style="color:var(--navy); text-decoration:underline;">観光編はこちら &raquo;</a>
            </div>
        </div>

        <!-- 各コース試験セクション -->
        <div id="beginner-exam" class="exam-section">
            <h2 class="section-title">課長コース 試験中</h2>
            <div id="beginner-questions"></div>
            <div class="text-center mt-4">
                <button class="cta-button" onclick="submitAnswers('beginner')">採点する</button>
            </div>
        </div>

        <div id="intermediate-exam" class="exam-section">
            <h2 class="section-title">部長コース 試験中</h2>
            <div id="intermediate-questions"></div>
            <div class="text-center mt-4">
                <button class="cta-button" onclick="submitAnswers('intermediate')">採点する</button>
            </div>
        </div>

        <div id="advanced-exam" class="exam-section">
            <h2 class="section-title">市長コース 試験中</h2>
            <div id="advanced-questions"></div>
            <div class="text-center mt-4">
                <button class="cta-button" onclick="submitAnswers('advanced')">採点する</button>
            </div>
        </div>

        <!-- 結果表示 -->
        <div id="result-section">
            <div class="difficulty-card" style="cursor:default; transform:none;">
                <h2 style="font-family:'Noto Serif JP'; margin-bottom:1rem;">試験結果</h2>
                <div id="result-message" style="font-size:1.2rem; font-weight:bold; margin-bottom:1rem;"></div>
                <div id="result-score" style="font-size:3rem; color:var(--vermilion); font-weight:bold;"></div>
                <div id="result-rank" style="color:var(--text-light);"></div>

                <div id="certificate-container" style="margin-top:2rem; display:none;">
                    <div style="border:4px double var(--gold); padding:2rem; border-radius:8px; background:#fffcf5;">
                        <h3 style="color:var(--gold);">MUNAKATA KENTEI</h3>
                        <div id="certificate-badge-img" style="width:100px; height:100px; margin:1rem auto;"></div>
                        <div style="font-size:1.5rem; font-weight:bold; margin:0.5rem 0;">デジタル認定証</div>
                        <div id="certificate-level-name"></div>
                        <div style="margin-top:1rem; font-size:0.9rem; color:#888;" id="certificate-date"></div>
                    </div>
                </div>

                <div style="margin-top:2rem;">
                    <button class="cta-button" onclick="retryExam()">もう一度挑戦する</button>
                    <button class="cta-button" style="background:var(--navy); margin-top:10px;"
                        onclick="location.href='../kanko/index.html'">観光編へ</button>
                </div>
            </div>

            <div id="answer-review" style="margin-top:3rem;">
                <h3 style="border-bottom:2px solid var(--light-gray); padding-bottom:0.5rem;">回答確認</h3>
                <div id="review-content"></div>
            </div>
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // 問題データ (既存のデータをそのまま使用)
        const allQuestions = {
            "beginner": [
                { "id": "q1", "question": "福岡市と北九州市の中間に位置する宗像市。北側はどの海に面しているでしょうか？", "options": ["有明海", "玄界灘", "瀬戸内海"], "correct": 1, "explanation": "宗像市は玄界灘に面しており、この海は古代から大陸との交易の重要な航路でした。" },
                { "id": "q2", "question": "平成29年（2017年）にユネスコ世界文化遺産に登録された遺産群の名称は、「『〇〇〇島』宗像・沖ノ島と関連遺産群」です。〇に入る言葉は？", "options": ["宝の", "神宿る", "祈りの"], "correct": 1, "explanation": "正式名称は「『神宿る島』宗像・沖ノ島と関連遺産群」で、沖ノ島は神聖な島として崇められてきました。" },
                { "id": "q3", "question": "宗像市出身の実業家で、出光興産の創業者であり、小説『海賊とよばれた男』のモデルとしても知られる人物は誰でしょうか？", "options": ["出光佐三", "松下幸之助", "渋沢栄一"], "correct": 0, "explanation": "出光佐三は宗像市出身の実業家で、出光興産を創業し、その波乱万丈な人生は小説『海賊とよばれた男』のモデルとなりました。" },
                { "id": "q4", "question": "宗像市の「市の木」の一つで、市内の文化施設「宗像ユリックス」の名前の由来にもなっている木は何でしょうか？", "options": ["スギ", "マツ", "クスノキ"], "correct": 2, "explanation": "クスノキは宗像市の市の木の一つで、「ユリックス」の名前は「ユリ」（市の花）と「クス」（クスノキ）から名付けられました。" },
                { "id": "q5", "question": "宗像市の「市の魚」に制定されており、市内では「玄ちゃん」の愛称でも親しまれている魚は何でしょうか？", "options": ["マアジ", "タイ", "イカ"], "correct": 0, "explanation": "マアジが宗像市の市の魚で、玄界灘で獲れることから「玄ちゃん」という愛称で親しまれています。" },
                { "id": "q6", "question": "宗像市の「市の花」で、市が自生の北限とされているユリの名前は何でしょうか？", "options": ["テッポウユリ", "カノコユリ", "ヤマユリ"], "correct": 1, "explanation": "カノコユリは宗像市の市の花で、宗像市がこのユリの自生の北限地とされています。" },
                { "id": "q7", "question": "宗像大社が祀っている神様は、「宗像〇女神」と呼ばれています。数字の〇に入るのは？", "options": ["三", "五", "七"], "correct": 0, "explanation": "宗像大社は「宗像三女神」を祀っており、これらの女神は古代日本で重要な信仰対象でした。" },
                { "id": "q8", "question": "宗像市にあるJR鹿児島本線の主要駅で、市役所の最寄り駅（バス利用）でもある駅はどこでしょうか？", "options": ["赤間駅", "東郷駅", "教育大前駅"], "correct": 0, "explanation": "赤間駅はJR鹿児島本線の主要駅で、宗像市役所の最寄り駅です。" },
                { "id": "q9", "question": "宗像市で最も標高が高い山（499.0メートル）の名前は何でしょうか？", "options": ["城山", "孔大寺山", "許斐山"], "correct": 1, "explanation": "孔大寺山が宗像市で最も標高が高い山で、499.0メートルです。" },
                { "id": "q10", "question": "世界遺産の構成資産の一つで、海を隔てて沖ノ島を拝むために大島に作られた場所を何というでしょうか？", "options": ["沖津宮遥拝所", "中津宮", "辺津宮"], "correct": 0, "explanation": "沖津宮遥拝所は大島に作られた場所で、沖ノ島を拝むために造営されました。" },
                { "id": "q11", "question": "令7年12月、宗像ユリックス内に開業した、株式会社くりえいとが関わる「全天候型こども広場」の愛称は何でしょうか？", "options": ["Mu-Mo（ムーモ）", "Aso-Bo（アソボ）", "Muna-Kids（ムナキッズ）"], "correct": 0, "explanation": "令7年12月に宗像ユリックス内に開業した全天候型こども広場の愛称はMu-Mo（ムーモ）です。" }
            ],
            "intermediate": [
                { "id": "q11", "question": "平成15年（2003年）に旧宗像市と合併して「新しい宗像市」となった町はどこでしょうか？", "options": ["津屋崎町", "玄海町", "大島村"], "correct": 1, "explanation": "平成15年に旧宗像市と玄海町が合併して、新しい宗像市が誕生しました。" },
                { "id": "q12", "question": "宗像市の市章は、宗像市の頭文字「m」ともう一つの文字を組み合わせてデザインされています。旧玄海町を表すその文字は何でしょうか？", "options": ["g", "k", "s"], "correct": 1, "explanation": "宗像市の市章は「m」と「k」（玄海町のK）を組み合わせてデザインされています。" },
                { "id": "q13", "question": "宗像市の「市の鳥」であるオオミズナギドリは、天然記念物にも指定されていますが、主な生息地となっている島はどこでしょうか？", "options": ["大島", "地島", "沖ノ島"], "correct": 0, "explanation": "オオミズナギドリは宗像市の市の鳥で、大島が主な生息地です。" },
                { "id": "q14", "question": "宗像市と姉妹都市を締結している、古代日本との交流の歴史も深い韓国の都市はどこでしょうか？", "options": ["釜山市", "ソウル市", "金海市"], "correct": 2, "explanation": "宗像市は韓国の金海市と姉妹都市を締結しており、古代からの交流の歴史があります。" },
                { "id": "q15", "question": "出光佐三が創業した出光興産の本社が置かれている都市はどこでしょうか？", "options": ["東京", "大阪", "福岡"], "correct": 0, "explanation": "出光興産の本社は東京に置かれています。" },
                { "id": "q16", "question": "宗像大社の本殿などの改修が完了した「昭和の御造営」は昭和何年でしょうか？", "options": ["昭和38年", "昭和46年", "昭和56年"], "correct": 2, "explanation": "昭和56年に宗像大社の「昭和の御造営」として本殿などの改修が完了しました。" },
                { "id": "q17", "question": "千葉県にある出光興産の千葉製油所には、宗像大社の本殿を模した神社が建立されています。その大きさは実物の何分の一でしょうか？", "options": ["1/2", "1/5", "1/10"], "correct": 2, "explanation": "千葉製油所の神社は宗像大社の本殿を模した1/10の大きさで建立されています。" },
                { "id": "q18", "question": "大島では、市の鳥である「オオミズナギドリ」のことを地元の方言で何と呼ぶでしょうか？", "options": ["オガチ", "ウミガラス", "カツオドリ"], "correct": 0, "explanation": "大島ではオオミズナギドリを「オガチ」と呼ぶ地元の方言があります。" },
                { "id": "q19", "question": "旧玄海町と友好交流都市を締結していた韓国・済州島の「城山邑（ソンサンウプ）」は、行政改編により現在は何という市の一部になっているでしょうか？", "options": ["済州市", "西帰浦（ソギポ）市", "漢拏（ハルラ）市"], "correct": 0, "explanation": "城山邑は行政改編により、現在は済州市の一部になっています。" },
                { "id": "q20", "question": "出光佐三の事業の基本理念であり、苦しい時代も貫き通した考え方は「〇〇〇本位」です。〇に入る言葉は？", "options": ["利益", "国家", "消費者"], "correct": 2, "explanation": "出光佐三の経営理念は「消費者本位」で、これは彼の事業の基本となりました。" }
            ],
            "advanced": [
                { "id": "q21", "question": "昭和56年、旧宗像町は人口が何万人を突破したことを機に「旧宗像市」となったでしょうか？", "options": ["3万人", "5万人", "10万人"], "correct": 1, "explanation": "昭和56年、旧宗像町は人口が5万人を突破したことを機に「旧宗像市」となりました。" },
                { "id": "q22", "question": "ブルガリアのカザンラック市で開催される「バラ祭り」の最終日に選ばれる女性の称号は何でしょうか？", "options": ["バラの女王", "ローズプリンセス", "花の女神"], "correct": 0, "explanation": "ブルガリアのカザンラック市で開催される「バラ祭り」の最終日に選ばれる女性の称号は「バラの女王」です。" },
                { "id": "q23", "question": "宗像市の文化財である「宗像大社辺津宮本殿」は、何時代の建築様式を示しているでしょうか？", "options": ["平安時代", "室町時代", "江戸時代"], "correct": 2, "explanation": "宗像大社辺津宮本殿は江戸時代の建築様式を示しており、国の重要文化財に指定されています。" },
                { "id": "q24", "question": "宗像市が実施している「宗像ユリックス24時間駅伝」は、第何回大会でしょうか？", "options": ["第30回", "第32回", "第35回"], "correct": 1, "explanation": "宗像ユリックス24時間駅伝は第32回大会が開催されており、240分部門が新設されました。" },
                { "id": "q25", "question": "宗像市内で栽培される「宗像サーモン」は、どのような方法で養殖されているでしょうか？", "options": ["海水養殖", "陸上養殖", "池での養殖"], "correct": 1, "explanation": "宗像サーモンは地下水を利用した陸上養殖で、西日本最大級の施設で生産されています。" },
                { "id": "q26", "question": "宗像市の「市民の日」は、いつに制定されているでしょうか？", "options": ["1月1日", "3月20日", "11月3日"], "correct": 1, "explanation": "宗像市の「市民の日」は3月20日に制定されています。" },
                { "id": "q27", "question": "宗像大社の沖津宮が鎮座する沖ノ島は、女人禁制の島として知られていますが、この禁制は何年から続いているでしょうか？", "options": ["約1000年", "約1500年", "約2000年"], "correct": 1, "explanation": "沖ノ島の女人禁制は約1500年前から続いており、古代からの伝統が守られています。" },
                { "id": "q28", "question": "宗像市にある「道の駅むなかた」では、地域特産品の販売が行われていますが、最近注目を集めている特産品は何でしょうか？", "options": ["宗像ユリ", "宗像サーモン", "玄ちゃんアジ"], "correct": 1, "explanation": "道の駅むなかたでは、陸上養殖の「宗像サーモン」が注目を集めており、12月から販売が開始されました。" },
                { "id": "q29", "question": "宗像市の歴史を学ぶことができる施設「宗像大社神宝館」には、どのような文化財が展示されているでしょうか？", "options": ["陶芸作品", "古代の祭祀遺物", "現代美術"], "correct": 1, "explanation": "宗像大社神宝館には、古代の祭祀遺物や宗像大社に関連する重要な文化財が展示されています。" },
                { "id": "q30", "question": "宗像市を代表する観光地「宗像大社」の参拝者数は、年間何万人程度でしょうか？", "options": ["約50万人", "約100万人", "約200万人"], "correct": 1, "explanation": "宗像大社の年間参拝者数は約100万人で、宗像市を代表する観光地となっています。" }
            ]
        };

        let currentDifficulty = null;
        let currentScore = 0;

        function startExam(difficulty) {
            currentDifficulty = difficulty;
            document.getElementById('difficulty-selection').classList.add('hidden');
            document.getElementById(difficulty + '-exam').classList.add('active');
            renderQuestions(difficulty);
            window.scrollTo(0, 0);
        }

        function renderQuestions(difficulty) {
            const questions = allQuestions[difficulty];
            const container = document.getElementById(difficulty + '-questions');
            container.innerHTML = '';

            questions.forEach((q, idx) => {
                const questionHTML = `
                    <div style="background:white; padding:1.5rem; border-radius:12px; margin-bottom:1.5rem; box-shadow:var(--shadow-sm);">
                        <div style="font-weight:bold; color:var(--text-light); margin-bottom:0.5rem;">第${idx + 1}問</div>
                        <div style="font-size:1.1rem; margin-bottom:1rem; font-weight:500;">${q.question}</div>
                        <div style="display:flex; flex-direction:column; gap:0.75rem;">
                            ${q.options.map((opt, optIdx) => `
                                <label style="display:flex; align-items:center; background:var(--off-white); padding:1rem; border-radius:8px; cursor:pointer;">
                                    <input type="radio" name="${q.id}" value="${optIdx}" style="margin-right:1rem;">
                                    <span>${opt}</span>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.innerHTML += questionHTML;
            });
        }

        function submitAnswers(difficulty) {
            const questions = allQuestions[difficulty];
            let score = 0;
            let answers = {};
            let isAllAnswered = true;

            questions.forEach(q => {
                const selected = document.querySelector(`input[name="${q.id}"]:checked`);
                if (selected) {
                    const answer = parseInt(selected.value);
                    answers[q.id] = {
                        selected: answer,
                        correct: q.correct,
                        isCorrect: answer === q.correct,
                        question: q.question,
                        options: q.options,
                        explanation: q.explanation
                    };
                    if (answer === q.correct) {
                        const pointsPerQuestion = difficulty === 'beginner' ? Math.round(100 / 11 * 100) / 100 : 10;
                        score += pointsPerQuestion;
                    }
                } else {
                    isAllAnswered = false;
                    answers[q.id] = { selected: -1, correct: q.correct, isCorrect: false, question: q.question, options: q.options, explanation: q.explanation };
                }
            });

            if (!isAllAnswered) {
                if (!confirm('未回答の問題があります。採点してもよろしいですか？')) return;
            }

            currentScore = Math.round(score);
            displayResults(currentScore, difficulty, answers);
        }

        function displayResults(score, difficulty, answers) {
            document.getElementById(difficulty + '-exam').classList.remove('active');
            document.getElementById('result-section').classList.add('active');
            document.getElementById('result-score').textContent = score + '点';

            let message = '';
            let rank = '';
            const isPassed = score >= 60;

            if (score >= 80) {
                message = '<span class="result-icon success">★</span> 素晴らしい成績です！';
                rank = '評価: 優秀（80点以上）';
            } else if (score >= 60) {
                message = '<span class="result-icon success">✓</span> 良好な成績です！';
                rank = '評価: 合格（60点以上）';
            } else {
                message = '<span class="result-icon">!</span> もう一度チャレンジしてみましょう！';
                rank = '評価: 再受検推奨（60点未満）';
            }

            document.getElementById('result-message').innerHTML = message;
            document.getElementById('result-rank').textContent = rank;

            if (isPassed) {
                document.getElementById('certificate-container').style.display = 'block';
                const courseNames = { beginner: '課長コース', intermediate: '部長コース', advanced: '市長コース' };
                document.getElementById('certificate-level-name').textContent = courseNames[difficulty];

                const today = new Date();
                document.getElementById('certificate-date').textContent = `${today.getFullYear()}年${today.getMonth() + 1}月${today.getDate()}日`;

                const badgeImgs = {
                    beginner: '../images/course_kacho.webp',
                    intermediate: '../images/course_bucho.webp',
                    advanced: '../images/course_shicho.webp'
                };
                document.getElementById('certificate-badge-img').innerHTML = `<img src="${badgeImgs[difficulty]}" style="width:100%;height:100%;object-fit:cover;border-radius:50%">`;
            } else {
                document.getElementById('certificate-container').style.display = 'none';
            }

            // 解説表示
            const reviewDiv = document.getElementById('review-content');
            reviewDiv.innerHTML = '';
            Object.values(answers).forEach((ans, idx) => {
                const icon = ans.isCorrect ? '<span class="review-icon correct">✓</span>' : '<span class="review-icon incorrect">✕</span>';
                const html = `
                    <div style="background:white; padding:1rem; border-radius:8px; margin-bottom:1rem; border-left:4px solid ${ans.isCorrect ? 'var(--cf-green)' : 'var(--vermilion)'}">
                        <div style="font-weight:bold; margin-bottom:0.5rem;">${icon} 第${idx + 1}問: ${ans.question}</div>
                        <div style="font-size:0.9rem; color:#555; margin-bottom:0.5rem;">あなたの回答: ${ans.selected >= 0 ? ans.options[ans.selected] : '未回答'} / 正解: ${ans.options[ans.correct]}</div>
                        <div style="font-size:0.9rem; background:var(--off-white); padding:0.5rem; border-radius:4px;">解説: ${ans.explanation}</div>
                    </div>
                `;
                reviewDiv.innerHTML += html;
            });
            window.scrollTo(0, 0);
        }

        function retryExam() {
            document.getElementById('result-section').classList.remove('active');
            document.getElementById('difficulty-selection').classList.remove('hidden');
            window.scrollTo(0, 0);
        }
    </script>
</body>

</html>